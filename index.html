<!doctype html>
<html lang="hu">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="theme-color" content="#1b1f2a" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <title>Ki nevet a v√©g√©n ‚Äì Online (2‚Äì4)</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header class="topbar">
    <div class="brand">
      <span class="logo">üé≤</span>
      <div class="brandtxt">
        <div class="t">Ki nevet a v√©g√©n</div>
        <div class="s">online szob√°s ‚Ä¢ 2‚Äì4 j√°t√©kos ‚Ä¢ tel√≥/g√©p</div>
      </div>
    </div>

    <div class="top-actions">
      <button class="btn ghost" id="btnRules" type="button">Szab√°lyok</button>
      <button class="btn ghost" id="btnLeave" type="button" disabled>Kil√©p√©s</button>
    </div>
  </header>

  <main class="layout">
    <section class="board-card" aria-label="J√°t√©kt√°bla">
      <div class="board-shell">
        <div id="board" class="board" role="application" aria-label="Ki nevet a v√©g√©n t√°bla"></div>
      </div>
      <div class="board-help" id="boardHelp">
        Dob√°shoz katt a kock√°ra (csak ha te j√∂ssz).
      </div>
      <div class="underbar" id="underbar">
        <div class="turnpill" id="underTurn">
          <span class="dot" id="underDot"></span>
          <span class="txt" id="underName">‚Äî</span>
        </div>
        <button class="dicebtn" id="uiDice" type="button" aria-label="Kocka">
          <span id="uiDiceFace">‚Äî</span>
        </button>
      </div>
    </section>

    <section class="panel" aria-label="Vez√©rl≈ëpanel">
      <div class="status">
        <div class="pill">
          <span class="pill-dot" id="turnDot" aria-hidden="true"></span>
          <span class="pill-text" id="turnName">‚Äî</span>
        </div>
        <div class="mini" id="turnMeta">‚Äî</div>

        <div class="netrow">
          <span class="tag">Realtime</span>
          <span class="pill2" id="netState">init</span>
        </div>
      </div>

      <div class="panel-actions">
        <button class="btn primary" id="btnStartMain" type="button" hidden disabled>Start</button>
        <button class="btn" id="btnRoll" type="button" disabled>Dob√°s (backup)</button>
        <button class="btn" id="btnSkip" type="button" disabled>Passz</button>
      </div>

      <div class="hint" id="hint">Csatlakozz egy szob√°hoz vagy csin√°lj √∫jat.</div>

      <div class="roombar" id="roomBar" hidden>
        <div class="roompill">
          <span class="tag">Szoba</span>
          <span class="code" id="roomCodeText">‚Äî</span>
        </div>
        <button class="btn ghost" id="btnCopy" type="button">K√≥d m√°sol√°s</button>
      </div>

      <div class="score" id="score"></div>

      <div class="logwrap">
        <div class="logtitle">Napl√≥</div>
        <div class="log" id="log" aria-live="polite"></div>
      </div>
    </section>
  </main>

  <!-- Lobby modal -->
  <div class="modal show" id="lobbyModal" aria-hidden="false">
    <div class="modal-card" role="dialog" aria-modal="true" aria-labelledby="lobbyTitle">
      <div class="modal-head">
        <div class="modal-title" id="lobbyTitle">Online szoba</div>
        <div class="modal-right">
          <span class="pill2" id="netState2">init</span>
        </div>
      </div>

      <div class="modal-body">
        <div class="grid2">
          <div class="field">
            <label for="yourName">Neved</label>
            <input id="yourName" type="text" placeholder="pl. Tes√≥" maxlength="18" />
          </div>

          <div class="field">
            <label for="roomCode">Szobak√≥d</label>
            <input id="roomCode" type="text" placeholder="pl. K8F2QZ" maxlength="10" />
            <div class="help">Ha van k√≥d: Join. Ha nincs: Create (hagyd √ºresen).</div>
          </div>
        </div>

        <div class="grid2">
          <div class="field">
            <label for="playerCount">J√°t√©kosok sz√°ma</label>
            <select id="playerCount">
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4" selected>4</option>
            </select>
            <div class="help">Create-n√©l sz√°m√≠t. Startolni m√°r 2 f≈ët≈ël lehet.</div>
          </div>

          <div class="field">
            <label>Opci√≥k</label>
            <label class="check"><input type="checkbox" id="optExtraTurnOnSix" checked /> <span>6-osn√°l m√©g egy dob√°s</span></label>
            <label class="check"><input type="checkbox" id="optAutoMove" checked /> <span>Auto-l√©p√©s (ha 1 opci√≥)</span></label>
          </div>
        </div>

        <div class="lobbyState" id="lobbyState" hidden>
          <div class="row">
            <div class="roompill big">
              <span class="tag">K√≥d</span>
              <span class="code" id="roomCodeBig">‚Äî</span>
            </div>
            <button class="btn ghost" id="btnCopyBig" type="button">M√°sol</button>
          </div>

          <div class="players" id="playersList"></div>
          <div class="help">Host ind√≠t: Start (min. 2 f≈ë). A kocka is m≈±k√∂dik.</div>
        </div>
      </div>

      <div class="modal-actions split">
        <button class="btn" id="btnJoin" type="button">Join</button>
        <button class="btn primary" id="btnCreate" type="button">Create</button>
        <button class="btn primary" id="btnStart" type="button" hidden>Start</button>
      </div>

      <div class="modal-footnote">
        <span class="muted2">Supabase (Realtime + DB) ‚Ä¢ GitHub Pages frontend</span>
      </div>
    </div>
  </div>

  <!-- Rules modal -->
  <div class="modal" id="rulesModal" aria-hidden="true">
    <div class="modal-card" role="dialog" aria-modal="true" aria-labelledby="rulesTitle">
      <div class="modal-head">
        <div class="modal-title" id="rulesTitle">Szab√°lyok</div>
        <button class="btn ghost icon" id="btnCloseRules" type="button" aria-label="Bez√°r√°s">‚úï</button>
      </div>
      <div class="modal-body prose">
        <ul>
          <li>2‚Äì4 j√°t√©kos. Join ugyanazzal a k√≥ddal.</li>
          <li>Dob√°s: kock√°ra katt, vagy ‚ÄúDob√°s‚Äù gomb (backup).</li>
          <li>6-os kell a b√°bu kihoz√°s√°hoz.</li>
          <li>Dob√°s ut√°n megmutatja, hova √©rkezne a b√°bu (c√©ljel√∂l≈ëk).</li>
          <li>√út√©s: ha nem v√©dett mez≈ën √°ll az ellenf√©l, haza megy.</li>
          <li>V√©dett: csak a saj√°t start mez≈ëd (a t√∂bbiek startja nem v√©dett neked).</li>
          <li>Hazafel√©: el≈ëbb elmegy a bej√°ratig, ut√°na megy be a sz√≠nes sorba (nem v√°g le).</li>
        </ul>
      </div>
    </div>
  </div>

  <!-- Win modal -->
  <div class="modal" id="winModal" aria-hidden="true">
    <div class="modal-card" role="dialog" aria-modal="true" aria-labelledby="winTitle">
      <div class="modal-head">
        <div class="modal-title" id="winTitle">V√©ge</div>
        <button class="btn ghost icon" id="btnCloseWin" type="button" aria-label="Bez√°r√°s">‚úï</button>
      </div>
      <div class="modal-body prose">
        <p id="winText">‚Äî</p>
      </div>
      <div class="modal-actions">
        <button class="btn primary" id="btnBackLobby" type="button">Vissza a lobbyba</button>
      </div>
    </div>
  </div>

  <div id="mHostCode" class="mHostCode" hidden>
    <span class="tag">K√≥d</span> <span id="mHostCodeText">‚Äî</span>
  </div>

  <!-- Supabase -->
  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
  <script src="app.js"></script>
</body>
</html>
